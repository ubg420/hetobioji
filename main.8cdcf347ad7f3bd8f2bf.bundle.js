(()=>{var t,s={982:(t,s,e)=>{"use strict";var i;e(260);class a extends Phaser.GameObjects.Text{constructor(t){super(t,10,10,"",{color:"black",fontSize:"28px"}),t.add.existing(this),this.setScrollFactor(0)}update(){this.setText(`fps: ${Math.floor(this.scene.game.loop.actualFps)}`)}}!function(t){t.OJI="oji",t.KOZO="kozo",t.MADAME="madame",t.NEKO="neko",t.HAKASE="hakase",t.GOLD="gold"}(i||(i={}));class h{constructor(){this.isOhana=!1,this.playerType=i.OJI}static getInstance(){return h.instance||(h.instance=new h),h.instance}setPlayerType(t){this.playerType=t}setIsOhana(t){this.isOhana=t}}const o=h;class r extends Phaser.GameObjects.Container{constructor(t,s,e,i,a){super(t,s,e),this.onaraSounds=[],this.seVolume=1,this.parent=i,this.parentSprite=a,this.config=o.getInstance(),this.config.isOhana?this.createOhana(t):this.createOnara(t),this.onara.y=14}createOnara(t){const s="onara";this.onara=t.add.particles(s),this.onaraEmitter=this.onara.createEmitter({speed:150,scale:{start:.5,end:4},angle:{min:100,max:100},lifespan:500,frequency:140,alpha:{start:1,end:0}}),this.onaraEmitter.startFollow(this.parent,0,1),this.onaraEmitter.stop(),this.onaraRoll=t.add.particles(s),this.onaraRollEmitter=this.onaraRoll.createEmitter({speed:350,scale:{start:.2,end:4},angle:{min:0,max:0},lifespan:350,frequency:50,alpha:{start:1,end:0}}),this.parent.add(this.onaraRoll),this.onaraRollEmitter.stop(),this.startOnara=t.add.particles(s),this.startOnaraEmitter=this.startOnara.createEmitter({speed:200,scale:{start:.5,end:6},angle:{min:40,max:200},lifespan:400,frequency:10,alpha:{start:1,end:0},accelerationX:-10,accelerationY:-10}),this.startOnaraEmitter.startFollow(this.parent,0,10),this.startOnaraEmitter.stop(),this.onaraRespawn=t.add.particles(s),this.onaraRespawnEmitter=this.onaraRespawn.createEmitter({speed:200,scale:{start:.5,end:4},angle:{min:0,max:360},lifespan:300,frequency:1,alpha:{start:1,end:0}}),this.onaraRespawnEmitter.startFollow(this.parent,0,1),this.onaraRespawnEmitter.stop(),this.respawnSE=t.sound.add("respawn"),this.onaraSounds=[t.sound.add("onara1"),t.sound.add("onara2"),t.sound.add("onara3"),t.sound.add("onara4"),t.sound.add("onara5"),t.sound.add("onara6"),t.sound.add("onara7"),t.sound.add("onara8"),t.sound.add("onara9"),t.sound.add("onara10"),t.sound.add("onara11")],this.hakaseOnara=t.add.particles(s),this.hakaseOnaraEmitter=this.onara.createEmitter({speed:300,scale:{start:.5,end:4},angle:{min:70,max:70},lifespan:500,frequency:80,alpha:{start:1,end:0}}),this.hakaseOnaraEmitter.startFollow(this.parent,0,1),this.hakaseOnaraEmitter.stop(),this.seVolume=1}createOhana(t){const s="ohana";this.onara=t.add.particles(s),this.onaraEmitter=this.onara.createEmitter({speed:200,scale:{start:.05,end:.4},angle:{min:100,max:100},rotate:{start:0,end:120},lifespan:600,frequency:140,alpha:{start:1,end:0}}),this.onaraEmitter.startFollow(this.parent,0,1),this.onaraEmitter.stop(),this.onaraRoll=t.add.particles(s),this.onaraRollEmitter=this.onaraRoll.createEmitter({speed:350,scale:{start:.02,end:.4},angle:{min:0,max:0},rotate:{start:0,end:200},lifespan:500,frequency:50,alpha:{start:1,end:0}}),this.parent.add(this.onaraRoll),this.onaraRollEmitter.stop(),this.startOnara=t.add.particles(s),this.startOnaraEmitter=this.startOnara.createEmitter({speed:140,scale:{start:.05,end:.6},angle:{min:40,max:200},rotate:{start:50,end:120},lifespan:600,frequency:13,alpha:{start:1,end:0},accelerationX:-10,accelerationY:-10}),this.startOnaraEmitter.startFollow(this.parent,0,10),this.startOnaraEmitter.stop(),this.onaraRespawn=t.add.particles(s),this.onaraRespawnEmitter=this.onaraRespawn.createEmitter({speed:100,scale:{start:.05,end:.4},angle:{min:0,max:360},rotate:{start:80,end:239},lifespan:500,frequency:2,alpha:{start:1,end:0}}),this.onaraRespawnEmitter.startFollow(this.parent,0,1),this.onaraRespawnEmitter.stop(),this.respawnSE=t.sound.add("respawn"),this.onaraSounds=[t.sound.add("ohana1"),t.sound.add("ohana2"),t.sound.add("ohana3"),t.sound.add("ohana4")],this.hakaseOnara=t.add.particles(s),this.hakaseOnaraEmitter=this.onara.createEmitter({speed:300,scale:{start:.05,end:.4},angle:{min:70,max:70},rotate:{start:0,end:360},lifespan:500,frequency:80,alpha:{start:1,end:0}}),this.hakaseOnaraEmitter.startFollow(this.parent,0,1),this.hakaseOnaraEmitter.stop(),this.seVolume=.6}startHakaseOnara(){this.hakaseOnaraEmitter.start()}stopHakaseOnara(){this.hakaseOnaraEmitter.stop()}startEffect(t){this.onaraEmitter.start(),this.playSE(t);let s=.2+1*t,e=1+6*t;const i=100+200*t,a=50+200*t;this.config.isOhana&&(s*=.11,e*=.11),this.startOnaraEmitter.setScale({start:s,end:e}),this.startOnaraEmitter.setSpeed(i),this.startOnaraEmitter.start(),this.scene.time.addEvent({delay:a,callback:()=>{this.startOnaraEmitter.stop()}})}playSE(t){let s=Phaser.Math.FloatBetween(1.3,.8);s=s*(1-t)+.5*s,Phaser.Math.RND.pick(this.onaraSounds).play({rate:s,volume:this.seVolume})}stopEffect(){this.startOnaraEmitter.stop(),this.onaraEmitter.stop(),this.onaraRollEmitter.stop()}rollingEffect(t){this.onaraRollEmitter.setSpeed(150+300*t),this.onaraRollEmitter.frequency=250-220*t,this.onaraRollEmitter.start(),this.onaraEmitter.stop()}spawnEffect(){this.respawnSE.play(),this.onaraRespawnEmitter.start(),this.scene.time.addEvent({delay:250,callback:()=>{this.onaraRespawnEmitter.stop()}})}update(){if(!this.onaraRollEmitter.on)return;const t=this.parentSprite.rotation+90;this.parent.x,Math.cos(t),this.parent.y,Math.sin(t),this.onaraRollEmitter.setAngle({min:Phaser.Math.RadToDeg(t),max:Phaser.Math.RadToDeg(t)})}}var n;!function(t){t.IDLE="idle",t.JUMP="jump",t.EMPTY="empty",t.CHARGE="charge",t.MISS="MISS"}(n||(n={}));class c extends Phaser.GameObjects.Container{constructor(t,s,e,a){super(t,s,e),this.type=i.OJI,this.jumpPower=0,this.jumpPowerMin=70,this.jumpPowerMax=270,this.gravity=350,this.chargeSpeed=.35,this.jumpMax=2,this.jumpCount=0,this.frction=2,this.iceFriction=.05,this.maxFallSpeed=900,t.physics.world.gravity.y=this.gravity,this.body=new Phaser.Physics.Arcade.Body(t.physics.world,this),this.mainScene=t,this.sprite=t.add.sprite(0,0,this.type,0),this.sprite.play(this.type+"_idle"),this.onaraEffect=new r(t,0,0,this,this.sprite),this.add(this.sprite),this.state=n.IDLE,t.add.existing(this),t.physics.add.existing(this),this.sprite.setDisplaySize(40,40),this.body.setSize(15,21),this.body.setOffset(-7,-6),this.hunbari=t.add.image(0,0,this.type+"_hunbari"),this.add(this.hunbari),this.hunbari.setDisplaySize(40,40),this.hunbari.setVisible(!1),this.map=a,this.jumpCount=0,this.onara1SE=this.scene.sound.add("onara1"),this.onara2SE=this.scene.sound.add("onara2")}jump(){if(this.state!=n.CHARGE)return;if(this.jumpCount>=this.jumpMax)return;const t=this.jumpPower/this.jumpPowerMax;0==this.jumpCount?(this.body.setVelocityY(1.1*-this.jumpPower),this.body.setVelocityX(this.jumpPower)):1==this.jumpCount&&(this.body.setVelocityY(-1.4*this.jumpPower),this.body.setVelocityX(10+.7*this.jumpPower)),this.onaraEffect.startEffect(t),this.jumpPower=0,this.state=n.JUMP,this.sprite.play(this.type+"_jump"),this.hunbari.setVisible(!1),this.jumpCount++,this.jumpCount>=this.jumpMax&&(this.state=n.EMPTY,this.onaraEffect.rollingEffect(t))}chargeStart(){this.jumpCount>=this.jumpMax||(this.sprite.play(this.type+"_jump"),this.state=n.CHARGE)}charge(t){this.jumpPower<this.jumpPowerMin&&(this.jumpPower=this.jumpPowerMin),this.jumpPower<this.jumpPowerMax&&(this.jumpPower+=this.chargeSpeed*t),this.jumpPower>this.jumpPowerMax&&(this.jumpPower=this.jumpPowerMax),this.hunbari.setVisible(!0);const s=this.jumpPower/this.jumpPowerMax;this.hunbari.setCrop(0,28-22*s,40,22*s)}update(t,s){if(this.onaraEffect.update(),this.y>this.map.heightInPixels+100&&this.Miss(),this.state!=n.MISS){if(this.body.blocked.down){if(!(this.body.velocity.y<0)){const t=this.map.getTileAtWorldXY(this.x,this.y+20);if(t){let e=this.frction;t.properties.ice?(e=this.iceFriction,this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0))):this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0)),t.properties.dark&&this.mainScene.setDark()}this.jumpCount=0,this.onaraEffect.stopEffect()}}else this.mainScene.resetDark();switch(this.state){case n.IDLE:break;case n.JUMP:if(this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle")}break;case n.CHARGE:this.charge(s);break;case n.EMPTY:if(this.sprite.angle+=.003*this.body.velocity.x*s,this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.onaraEffect.stopEffect()}}this.body.velocity.y>this.maxFallSpeed&&this.body.setVelocityY(this.maxFallSpeed)}}respawn(t,s){this.setPosition(t,s),this.body.setVelocityX(0),this.body.setVelocityY(0),this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.jumpPower=0,this.hunbari.setVisible(!1),this.onaraEffect.stopEffect(),this.onaraEffect.spawnEffect()}Miss(){this.state=n.MISS,this.mainScene.miss()}}class d extends Phaser.GameObjects.Container{constructor(t,s,e,a){super(t,s,e),this.type=i.KOZO,this.jumpPower=0,this.jumpPowerMin=40,this.jumpPowerMax=170,this.gravity=230,this.chargeSpeed=.15,this.jumpMax=4,this.jumpCount=0,this.frction=2,this.iceFriction=.05,this.maxFallSpeed=900,t.physics.world.gravity.y=this.gravity,this.body=new Phaser.Physics.Arcade.Body(t.physics.world,this),this.body.gravity.y=1,this.mainScene=t,this.sprite=t.add.sprite(0,0,this.type,0),this.sprite.play(this.type+"_idle"),this.onaraEffect=new r(t,0,0,this,this.sprite),this.add(this.sprite),this.state=n.IDLE,t.add.existing(this),t.physics.add.existing(this),this.sprite.setDisplaySize(40,40),this.body.setSize(15,21),this.body.setOffset(-7,-6),this.hunbari=t.add.image(0,0,this.type+"_hunbari"),this.add(this.hunbari),this.hunbari.setDisplaySize(40,40),this.hunbari.setVisible(!1),this.map=a,this.jumpCount=0,this.onara1SE=this.scene.sound.add("onara1"),this.onara2SE=this.scene.sound.add("onara2")}jump(){if(this.state!=n.CHARGE)return;if(this.jumpCount>=this.jumpMax)return;const t=this.jumpPower/this.jumpPowerMax;this.body.setVelocityY(1.2*-this.jumpPower),this.body.setVelocityX(this.jumpPower),this.onaraEffect.startEffect(t),this.jumpPower=0,this.state=n.JUMP,this.sprite.play(this.type+"_jump"),this.hunbari.setVisible(!1),this.jumpCount++,this.jumpCount>=this.jumpMax&&(this.state=n.EMPTY,this.onaraEffect.rollingEffect(t))}chargeStart(){this.jumpCount>=this.jumpMax||(this.sprite.play(this.type+"_jump"),this.state=n.CHARGE)}charge(t){this.jumpPower<this.jumpPowerMin&&(this.jumpPower=this.jumpPowerMin),this.jumpPower<this.jumpPowerMax&&(this.jumpPower+=this.chargeSpeed*t),this.jumpPower>this.jumpPowerMax&&(this.jumpPower=this.jumpPowerMax),this.hunbari.setVisible(!0);const s=this.jumpPower/this.jumpPowerMax;this.hunbari.setCrop(0,28-22*s,40,22*s)}update(t,s){if(this.onaraEffect.update(),this.y>this.map.heightInPixels+100&&this.Miss(),this.state!=n.MISS){if(this.body.blocked.down){if(!(this.body.velocity.y<0)){const t=this.map.getTileAtWorldXY(this.x,this.y+20);if(t){let e=this.frction;t.properties.ice?(e=this.iceFriction,this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0))):this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0)),t.properties.dark&&this.mainScene.setDark()}this.jumpCount=0,this.onaraEffect.stopEffect()}}else this.mainScene.resetDark();switch(this.state){case n.IDLE:break;case n.JUMP:if(this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle")}break;case n.CHARGE:this.charge(s);break;case n.EMPTY:if(this.sprite.angle+=.003*this.body.velocity.x*s,this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.onaraEffect.stopEffect()}}this.body.velocity.y>this.maxFallSpeed&&this.body.setVelocityY(this.maxFallSpeed)}}respawn(t,s){this.setPosition(t,s),this.body.setVelocityX(0),this.body.setVelocityY(0),this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.jumpPower=0,this.hunbari.setVisible(!1),this.onaraEffect.stopEffect(),this.onaraEffect.spawnEffect()}Miss(){this.state=n.MISS,this.mainScene.miss()}}class p extends Phaser.GameObjects.Container{constructor(t,s,e,a){super(t,s,e),this.type=i.MADAME,this.jumpPower=0,this.gravity=300,this.jumpPowerMin=40,this.jumpPowerMax=220,this.chargeSpeed=.22,this.jumpMax=3,this.jumpCount=0,this.frction=2,this.iceFriction=.05,this.maxFallSpeed=900,t.physics.world.gravity.y=this.gravity,this.body=new Phaser.Physics.Arcade.Body(t.physics.world,this),this.body.gravity.y=1,this.mainScene=t,this.sprite=t.add.sprite(0,0,this.type,0),this.sprite.play(this.type+"_idle"),this.onaraEffect=new r(t,0,0,this,this.sprite),this.add(this.sprite),this.state=n.IDLE,t.add.existing(this),t.physics.add.existing(this),this.sprite.setDisplaySize(40,40),this.body.setSize(15,21),this.body.setOffset(-7,-6),this.hunbari=t.add.image(0,0,this.type+"_hunbari"),this.add(this.hunbari),this.hunbari.setDisplaySize(40,40),this.hunbari.setVisible(!1),this.map=a,this.jumpCount=0,this.onara1SE=this.scene.sound.add("onara1"),this.onara2SE=this.scene.sound.add("onara2")}jump(){if(this.state!=n.CHARGE)return;if(this.jumpCount>=this.jumpMax)return;const t=this.jumpPower/this.jumpPowerMax;this.jumpCount==this.jumpMax-1?(this.body.setVelocityY(1.45*-this.jumpPower),this.body.setVelocityX(.8*this.jumpPower)):(this.body.setVelocityY(1.25*-this.jumpPower),this.body.setVelocityX(this.jumpPower)),this.onaraEffect.startEffect(t),this.jumpPower=0,this.state=n.JUMP,this.sprite.play(this.type+"_jump"),this.hunbari.setVisible(!1),this.jumpCount++,this.jumpCount>=this.jumpMax&&(this.state=n.EMPTY,this.onaraEffect.rollingEffect(t))}chargeStart(){this.jumpCount>=this.jumpMax||(this.sprite.play(this.type+"_jump"),this.state=n.CHARGE)}charge(t){this.jumpPower<this.jumpPowerMin&&(this.jumpPower=this.jumpPowerMin),this.jumpPower<this.jumpPowerMax&&(this.jumpPower+=this.chargeSpeed*t),this.jumpPower>this.jumpPowerMax&&(this.jumpPower=this.jumpPowerMax),this.hunbari.setVisible(!0);const s=this.jumpPower/this.jumpPowerMax;this.hunbari.setCrop(0,28-27*s,40,27*s)}update(t,s){if(this.onaraEffect.update(),this.y>this.map.heightInPixels+100&&this.Miss(),this.state!=n.MISS){if(this.body.blocked.down){if(!(this.body.velocity.y<0)){const t=this.map.getTileAtWorldXY(this.x,this.y+20);if(t){let e=this.frction;t.properties.ice?(e=this.iceFriction,this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0))):this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0)),t.properties.dark&&this.mainScene.setDark()}this.jumpCount=0,this.onaraEffect.stopEffect()}}else this.mainScene.resetDark();switch(this.state){case n.IDLE:break;case n.JUMP:if(this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle")}break;case n.CHARGE:this.charge(s);break;case n.EMPTY:if(this.sprite.angle+=.003*this.body.velocity.x*s,this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.onaraEffect.stopEffect()}}this.body.velocity.y>this.maxFallSpeed&&this.body.setVelocityY(this.maxFallSpeed)}}respawn(t,s){this.setPosition(t,s),this.body.setVelocityX(0),this.body.setVelocityY(0),this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.jumpPower=0,this.hunbari.setVisible(!1),this.onaraEffect.stopEffect(),this.onaraEffect.spawnEffect()}Miss(){this.state=n.MISS,this.mainScene.miss()}}class l extends Phaser.GameObjects.Container{constructor(t,s,e,a){super(t,s,e),this.type=i.NEKO,this.jumpPower=0,this.jumpPowerMin=20,this.jumpPowerMax=160,this.chargeSpeed=.15,this.gravity=160,this.jumpMax=6,this.jumpCount=0,this.frction=2,this.iceFriction=.05,this.maxFallSpeed=900,t.physics.world.gravity.y=this.gravity,this.body=new Phaser.Physics.Arcade.Body(t.physics.world,this),this.body.gravity.y=1,this.mainScene=t,this.sprite=t.add.sprite(0,0,this.type,0),this.sprite.play(this.type+"_idle"),this.onaraEffect=new r(t,0,0,this,this.sprite),this.add(this.sprite),this.state=n.IDLE,t.add.existing(this),t.physics.add.existing(this),this.sprite.setDisplaySize(40,40),this.body.setSize(15,21),this.body.setOffset(-7,-6),this.hunbari=t.add.image(0,0,this.type+"_hunbari"),this.add(this.hunbari),this.hunbari.setDisplaySize(40,40),this.hunbari.setVisible(!1),this.map=a,this.jumpCount=0,this.onara1SE=this.scene.sound.add("onara1"),this.onara2SE=this.scene.sound.add("onara2")}jump(){if(this.state!=n.CHARGE)return;if(this.jumpCount>=this.jumpMax)return;const t=this.jumpPower/this.jumpPowerMax;this.body.setVelocityY(1.3*-this.jumpPower),this.body.setVelocityX(this.jumpPower),this.onaraEffect.startEffect(t),this.jumpPower=0,this.state=n.JUMP,this.sprite.play(this.type+"_jump"),this.hunbari.setVisible(!1),this.jumpCount++,this.jumpCount>=this.jumpMax&&(this.state=n.EMPTY,this.onaraEffect.rollingEffect(t))}chargeStart(){this.jumpCount>=this.jumpMax||(this.sprite.play(this.type+"_jump"),this.state=n.CHARGE)}charge(t){this.jumpPower<this.jumpPowerMin&&(this.jumpPower=this.jumpPowerMin),this.jumpPower<this.jumpPowerMax&&(this.jumpPower+=this.chargeSpeed*t),this.jumpPower>this.jumpPowerMax&&(this.jumpPower=this.jumpPowerMax),this.hunbari.setVisible(!0);const s=this.jumpPower/this.jumpPowerMax;this.hunbari.setCrop(0,28-23*s,40,23*s)}update(t,s){if(this.onaraEffect.update(),this.y>this.map.heightInPixels+100&&this.Miss(),this.state!=n.MISS){if(this.body.blocked.down){if(!(this.body.velocity.y<0)){const t=this.map.getTileAtWorldXY(this.x,this.y+20);if(t){let e=this.frction;t.properties.ice?(e=this.iceFriction,this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0))):this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0)),t.properties.dark&&this.mainScene.setDark()}this.jumpCount=0,this.onaraEffect.stopEffect()}}else this.mainScene.resetDark();switch(this.state){case n.IDLE:break;case n.JUMP:if(this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle")}break;case n.CHARGE:this.charge(s);break;case n.EMPTY:if(this.sprite.angle+=.003*this.body.velocity.x*s,this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.onaraEffect.stopEffect()}}this.body.velocity.y>this.maxFallSpeed&&this.body.setVelocityY(this.maxFallSpeed)}}respawn(t,s){this.setPosition(t,s),this.body.setVelocityX(0),this.body.setVelocityY(0),this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.jumpPower=0,this.hunbari.setVisible(!1),this.onaraEffect.stopEffect(),this.onaraEffect.spawnEffect()}Miss(){this.state=n.MISS,this.mainScene.miss()}}class m extends Phaser.GameObjects.Container{constructor(t,s,e,a){super(t,s,e),this.type=i.HAKASE,this.jumpPower=130,this.jumpPowerMin=70,this.jumpPowerMax=270,this.gravity=350,this.chargeSpeed=.05,this.jumpMax=2,this.jumpCount=0,this.frction=2,this.airFriction=.2,this.iceFriction=.05,this.airTime=0,this.airTimeMax=4e3,this.maxVY=-130,this.maxVX=300,this.vx=3,this.vy=.6,this.chargeTime=0,this.isMaxCharge=!1,this.maxFallSpeed=900,this.minSERate=.7,this.seVolume=1,t.physics.world.gravity.y=this.gravity,this.body=new Phaser.Physics.Arcade.Body(t.physics.world,this),this.mainScene=t,this.sprite=t.add.sprite(0,0,this.type,0),this.sprite.play(this.type+"_idle"),this.onaraEffect=new r(t,0,0,this,this.sprite),this.add(this.sprite),this.state=n.IDLE,t.add.existing(this),t.physics.add.existing(this),this.sprite.setDisplaySize(40,40),this.body.setSize(15,21),this.body.setOffset(-7,-6),this.hunbari=t.add.image(-4,-2,this.type+"_hunbari"),this.add(this.hunbari),this.hunbari.setDisplaySize(40,40),this.hunbari.setVisible(!1),this.map=a,this.jumpCount=0,o.getInstance().isOhana?(this.onara1SE=this.scene.sound.add("ohana_hakase"),this.minSERate=.45,this.seVolume=.6):(this.onara1SE=this.scene.sound.add("onara_hakase"),this.minSERate=.7,this.seVolume=1),this.airTime=0}jump(){this.state=n.IDLE,this.onaraEffect.stopHakaseOnara(),this.chargeTime=0,this.onara1SE.stop()}chargeStart(){if(this.jumpCount>=this.jumpMax)return;if(this.isMaxCharge)return;this.state=n.CHARGE,this.onaraEffect.startHakaseOnara();const t=this.airTime/this.airTimeMax;this.onara1SE.play({rate:this.minSERate+1*t,volume:this.seVolume})}charge(t){if(this.isMaxCharge)return void(this.chargeTime=0);if(this.airTime+=t,this.chargeTime+=t,this.jumpPower<this.jumpPowerMin&&(this.jumpPower=this.jumpPowerMin),this.jumpPower<this.jumpPowerMax&&(this.jumpPower+=this.chargeSpeed*t),this.airTime>this.airTimeMax)return this.isMaxCharge=!0,this.onaraEffect.stopHakaseOnara(),void this.onara1SE.stop();this.hunbari.setVisible(!0);const s=this.airTime/this.airTimeMax;this.hunbari.setCrop(0,28-22*s,40,22*s);const e=this.chargeTime/this.airTimeMax;this.airTime,this.airTimeMax;let i=this.body.velocity.x+this.vx*e*t;this.maxVX<i&&(i=this.maxVX);let a=this.body.velocity.y-t*this.vy;this.maxVY>a&&(a=this.maxVY),this.body.setVelocityX(i),this.body.setVelocityY(a)}update(t,s){if(this.onaraEffect.update(),this.y>this.map.heightInPixels+100&&this.Miss(),this.state!=n.MISS){if(this.body.blocked.down){if(!(this.body.velocity.y<0)){const t=this.map.getTileAtWorldXY(this.x,this.y+20);if(this.isMaxCharge=!1,this.jumpPower=0,this.airTime=0,t){let e=this.frction;t.properties.ice?(e=this.iceFriction,this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0))):this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0)),t.properties.dark&&this.mainScene.setDark()}this.jumpCount=0,this.hunbari.setVisible(!1),this.onaraEffect.stopEffect()}}else this.mainScene.resetDark();switch(this.state){case n.IDLE:this.body.blocked.down||this.body.velocity.x>0&&this.body.setVelocityX(this.body.velocity.x-s*this.airFriction);break;case n.JUMP:break;case n.CHARGE:if(this.charge(s),this.body.blocked.down){if(this.body.velocity.y<=0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.hunbari.setVisible(!1)}break;case n.EMPTY:if(this.sprite.angle+=.003*this.body.velocity.x*s,this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.onaraEffect.stopEffect()}}this.body.velocity.y>this.maxFallSpeed&&this.body.setVelocityY(this.maxFallSpeed)}}respawn(t,s){this.setPosition(t,s),this.body.setVelocityX(0),this.body.setVelocityY(0),this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.jumpPower=0,this.hunbari.setVisible(!1),this.onaraEffect.stopEffect(),this.onaraEffect.spawnEffect()}Miss(){this.state=n.MISS,this.mainScene.miss()}}class u extends Phaser.GameObjects.Container{constructor(t,s,e,a){super(t,s,e),this.type=i.GOLD,this.jumpPower=0,this.jumpPowerMin=70,this.jumpPowerMax=270,this.gravity=350,this.chargeSpeed=.35,this.jumpMax=2,this.jumpCount=0,this.frction=2,this.iceFriction=.05,this.maxFallSpeed=900,t.physics.world.gravity.y=this.gravity,this.body=new Phaser.Physics.Arcade.Body(t.physics.world,this),this.mainScene=t,this.sprite=t.add.sprite(0,0,this.type,0),this.sprite.play(this.type+"_idle"),this.onaraEffect=new r(t,0,0,this,this.sprite),this.add(this.sprite),this.state=n.IDLE,t.add.existing(this),t.physics.add.existing(this),this.sprite.setDisplaySize(40,40),this.body.setSize(15,21),this.body.setOffset(-7,-6),this.map=a,this.jumpCount=0,this.onara1SE=this.scene.sound.add("onara1"),this.onara2SE=this.scene.sound.add("onara2")}jump(){if(this.state!=n.CHARGE)return;if(this.jumpCount>=this.jumpMax)return;const t=this.jumpPower/this.jumpPowerMax;0==this.jumpCount?(this.body.setVelocityY(1.1*-this.jumpPower),this.body.setVelocityX(this.jumpPower)):1==this.jumpCount&&(this.body.setVelocityY(-1.4*this.jumpPower),this.body.setVelocityX(10+.7*this.jumpPower)),this.onaraEffect.startEffect(t),this.jumpPower=0,this.state=n.JUMP,this.sprite.play(this.type+"_jump"),this.jumpCount++,this.jumpCount>=this.jumpMax&&(this.state=n.EMPTY,this.onaraEffect.rollingEffect(t))}chargeStart(){this.jumpCount>=this.jumpMax||(this.sprite.play(this.type+"_jump"),this.state=n.CHARGE)}charge(t){this.jumpPower<this.jumpPowerMin&&(this.jumpPower=this.jumpPowerMin),this.jumpPower<this.jumpPowerMax&&(this.jumpPower+=this.chargeSpeed*t),this.jumpPower>this.jumpPowerMax&&(this.jumpPower=this.jumpPowerMax),this.jumpPower,this.jumpPowerMax}update(t,s){if(this.onaraEffect.update(),this.y>this.map.heightInPixels+100&&this.Miss(),this.state!=n.MISS){if(this.body.blocked.down){if(!(this.body.velocity.y<0)){const t=this.map.getTileAtWorldXY(this.x,this.y+20);if(t){let e=this.frction;t.properties.ice?(e=this.iceFriction,this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0))):this.body.velocity.x>0&&(this.body.setVelocityX(this.body.velocity.x-s*e),this.body.velocity.x<0&&this.body.setVelocityX(0)),t.properties.dark&&this.mainScene.setDark()}this.jumpCount=0,this.onaraEffect.stopEffect()}}else this.mainScene.resetDark();switch(this.state){case n.IDLE:break;case n.JUMP:if(this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle")}break;case n.CHARGE:this.charge(s);break;case n.EMPTY:if(this.sprite.angle+=.003*this.body.velocity.x*s,this.body.blocked.down){if(this.body.velocity.y<0)break;this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.onaraEffect.stopEffect()}}this.body.velocity.y>this.maxFallSpeed&&this.body.setVelocityY(this.maxFallSpeed)}}respawn(t,s){this.setPosition(t,s),this.body.setVelocityX(0),this.body.setVelocityY(0),this.state=n.IDLE,this.sprite.play(this.type+"_idle"),this.sprite.angle=0,this.jumpCount=0,this.jumpPower=0,this.onaraEffect.stopEffect(),this.onaraEffect.spawnEffect()}Miss(){this.state=n.MISS,this.mainScene.miss()}}class y extends Phaser.Scene{constructor(){super({key:"MainScene"}),this.isGameOver=!1,this.startX=0,this.timer=0,this.goalX=0,this.isZoom=!1,this.isDark=!1,this.zoomOutPoint=0,this.resetZoomOutPoint=0,this.background2Spot=0,this.background3Spot=0,this.backgroundMode=0,this.checkPointIndex=0,this.life=5,this.bgmIndex=0}create(){this.config=o.getInstance(),this.timer=0,this.startX=0,this.background=this.add.image(0,0,"background").setOrigin(-.75,-.74),this.background.setDisplaySize(.4*this.cameras.main.width,.4*this.cameras.main.height),this.background.setScrollFactor(0),this.background2=this.add.image(0,0,"background2").setOrigin(-.75,-.72),this.background2.setDisplaySize(.4*this.cameras.main.width,.4*this.cameras.main.height),this.background2.setScrollFactor(0),this.background2.visible=!1,this.background3=this.add.image(0,0,"background3").setOrigin(0,0),this.background3.setDisplaySize(.9*this.cameras.main.width,.9*this.cameras.main.height),this.background3.setScrollFactor(0),this.background3.visible=!1,this.fpsText=new a(this),this.map=this.make.tilemap({key:"map"});const t=this.map.addTilesetImage("tileset1","tileset1");if(this.background2Spot=this.map.findObject("Objects",(t=>"background2"===t.name)).x,this.background3Spot=this.map.findObject("Objects",(t=>"background3"===t.name)).x,this.config.playerType!=i.HAKASE){const t=this.add.image(0,0,"setumei1"),s=this.map.findObject("Objects",(t=>"Setumei1"===t.name));t.setScale(.62),t.setPosition(s.x,s.y);const e=this.add.image(0,0,"setumei2"),i=this.map.findObject("Objects",(t=>"Setumei2"===t.name));e.setScale(.62),e.setPosition(i.x,i.y);let a="setumei3_"+this.config.playerType;const h=this.add.image(0,0,a),o=this.map.findObject("Objects",(t=>"Setumei3"===t.name));h.setScale(.62),h.setPosition(o.x,o.y)}else{const t=this.add.image(0,0,"setumei_hakase"),s=this.map.findObject("Objects",(t=>"SetumeiHakase"===t.name));t.setScale(.4),t.setPosition(s.x,s.y)}const s=this.map.createLayer("Ground",t,0,0),e=this.map.findObject("Objects",(t=>"SpawnPoint"===t.name));this.map.findObject("Objects",(t=>"DebugSpawn"===t.name)),s.setCollisionByProperty({collides:!0});const h=this.physics.add.sprite(0,0,"goal"),r=this.map.findObject("Objects",(t=>"Goal"===t.name));h.setScale(2),h.setPosition(r.x,r.y),h.body.allowGravity=!1,this.goalX=r.x,this.checkPoints=this.map.filterObjects("CheckPoints",(t=>"CheckPoint"===t.name)),this.checkPoints.sort(((t,s)=>t.x-s.x));for(let t=0;t<this.checkPoints.length;t++){if(this.config.playerType==i.GOLD)continue;const s=this.physics.add.sprite(0,0,"goal");s.setScale(2),s.body.allowGravity=!1,s.setOrigin(.5,.96),s.setPosition(this.checkPoints[t].x,this.checkPoints[t].y)}this.checkPointIndex=0,this.nextCheckPoint=new Phaser.Math.Vector2(this.checkPoints[this.checkPointIndex].x,this.checkPoints[this.checkPointIndex].y),this.respawnPoint=new Phaser.Math.Vector2(e.x,e.y),this.startX=e.x;const n=new Phaser.Math.Vector2(0,0);switch(n.x=e.x,n.y=e.y,this.config.playerType){case i.KOZO:this.player=new d(this,n.x,n.y,this.map);break;case i.MADAME:this.player=new p(this,n.x,n.y,this.map);break;case i.NEKO:this.player=new l(this,n.x,n.y,this.map);break;case i.HAKASE:this.player=new m(this,n.x,n.y,this.map);break;case i.GOLD:this.player=new u(this,n.x,n.y,this.map);break;default:this.player=new c(this,n.x,n.y,this.map)}switch(this.startX=e.x,this.physics.world.addCollider(this.player,s),this.cameras.main.setBounds(0,0,this.map.widthInPixels,this.map.heightInPixels),this.resetCamera(),this.scene.launch("MainUIScene"),this.ui=this.scene.get("MainUIScene"),this.input.on("pointerdown",(t=>{this.isGameOver||this.player.chargeStart()})),this.input.on("pointerup",(t=>{this.isGameOver||this.player.jump()})),this.isGameOver=!1,this.isZoom=!1,this.isDark=!1,this.blackout=this.add.graphics(),this.blackout.fillStyle(0,1),this.blackout.fillRect(0,0,this.cameras.main.width,this.cameras.main.height),this.blackout.setAlpha(0),this.maskGraphics=this.add.graphics(),this.maskGraphics.fillStyle(16777215,1),this.maskGraphics.fillCircle(0,0,50),this.maskGraphics.setVisible(!1),this.mask=this.maskGraphics.createGeometryMask(this.maskGraphics),this.mask.invertAlpha=!0,this.blackout.setMask(this.mask),this.maskGraphics.setScale(2),this.maskGraphics.setAlpha(.5),this.zoomOutPoint=this.map.findObject("Objects",(t=>"ZoomOut"===t.name)).x,this.resetZoomOutPoint=this.map.findObject("Objects",(t=>"ResetZoomOut"===t.name)).x,this.backgroundMode=0,this.bgm=this.sound.add("bgm1",{loop:!0,volume:.3}),this.bgm.play(),this.bgm2=this.sound.add("bgm2",{loop:!0,volume:0}),this.bgm2.stop(),this.bgm3=this.sound.add("bgm3",{loop:!0,volume:0}),this.bgm3.stop(),this.gameoverSE=this.sound.add("gameover"),this.life=5,this.config.playerType){case i.MADAME:this.life=7;break;case i.KOZO:this.life=10;break;case i.NEKO:this.life=20;break;case i.HAKASE:this.life=8;break;case i.GOLD:this.life=0}this.setLife(),this.bgm2PositionX=this.map.findObject("Objects",(t=>"BGM2"===t.name)).x,this.bgm3PositionX=this.map.findObject("Objects",(t=>"BGM3"===t.name)).x,this.bgmIndex=0}setLife(){if(this.config.playerType==i.GOLD)return;let t="oji_face";t=this.config.playerType+"_face";const s=this.map.filterObjects("Lifes",(t=>"Life"===t.name));for(let e=0;e<s.length;e++){const i=this.physics.add.sprite(0,0,t);i.setScale(2),i.body.allowGravity=!1,i.setOrigin(.5,.96),i.setPosition(s[e].x,s[e].y),i.body.setSize(16,16),this.physics.add.overlap(this.player,i,((t,s)=>{this.collectLife(t,s)}))}this.lifeupSE=this.sound.add("lifeup")}collectLife(t,s){s.destroy(),this.lifeupSE.play(),this.life++,this.ui.setLifeText(this.life)}setDark(){this.isDark||(this.maskTween&&this.maskTween.stop(),this.blackoutTween&&this.blackoutTween.stop(),this.maskTween=this.tweens.add({targets:this.maskGraphics,scaleX:1,scaleY:1,alpha:1,duration:500,ease:"Cubic"}),this.blackout.setAlpha(0),this.blackoutTween=this.tweens.add({targets:this.blackout,alpha:1,duration:500,ease:"Cubic"}),this.isDark=!0)}resetDark(){this.isDark&&(this.maskTween&&this.maskTween.stop(),this.blackoutTween&&this.blackoutTween.stop(),this.blackoutTween=this.tweens.add({targets:this.blackout,alpha:0,duration:1e3,ease:"Cubic"}),this.maskTween=this.tweens.add({targets:this.maskGraphics,scaleX:2,scaleY:2,alpha:0,duration:1e3,ease:"Cubic"}),this.isDark=!1)}resetCamera(){this.cameras.main.startFollow(this.player,!1,1,1,-190,0),this.cameras.main.setZoom(2.71)}zoomInCamera(){this.isZoom||(this.zoomTween&&this.zoomTween.stop(),this.zoomTween=this.tweens.add({targets:this.cameras.main,zoom:12,duration:300,ease:"easeIn",onUpdate:t=>{const s=t.progress,e=Phaser.Math.Interpolation.Linear([-170,0],s);this.cameras.main.followOffset.set(e,0)}}),this.isZoom=!0)}resetZoomInCamera(){this.isZoom&&(this.zoomTween&&this.zoomTween.stop(),this.zoomTween=this.tweens.add({targets:this.cameras.main,zoom:3,duration:600,ease:"Cubic",onUpdate:t=>{const s=t.progress,e=Phaser.Math.Interpolation.Linear([0,-170],s);this.cameras.main.followOffset.set(e,0)}}),this.isZoom=!1)}zoomOutCamera(){this.isZoom||(this.zoomTween&&this.zoomTween.stop(),this.zoomTween=this.tweens.add({targets:this.cameras.main,zoom:1.3,duration:2e3,ease:"Cubic",onUpdate:t=>{const s=t.progress,e=Phaser.Math.Interpolation.Linear([-170,-420],s);this.cameras.main.followOffset.set(e,0)}}),this.isZoom=!0)}resetZoomOutCamera(){this.isZoom&&(this.zoomTween&&this.zoomTween.stop(),this.zoomTween=this.tweens.add({targets:this.cameras.main,zoom:3,duration:1e3,onUpdate:t=>{const s=t.progress,e=Phaser.Math.Interpolation.Linear([-420,-170],s);this.cameras.main.followOffset.set(e,0)}}),this.isZoom=!1)}reload(){this.bgm.stop(),this.bgm2.stop(),this.bgm3.stop(),this.children.removeAll(),this.scene.restart()}miss(){this.life--,this.life<0?this.gameOver():(this.ui.setLifeText(this.life),this.player.respawn(this.respawnPoint.x,this.respawnPoint.y))}gameOver(){this.isGameOver||(this.gameoverSE.play(),this.isGameOver=!0,this.ui.gameOver(this.timer,this.calcScore()),this.player.destroy())}goal(){this.isGameOver||(this.isGameOver=!0,this.ui.goal(this.timer,this.calcScore()))}update(t,s){this.checkBackground(),this.checkCheckPoint(),this.checkBGMPoint(),this.player.x>this.zoomOutPoint&&this.player.x<this.resetZoomOutPoint&&this.zoomOutCamera(),this.player.x>this.resetZoomOutPoint&&this.resetZoomOutCamera(),this.maskGraphics&&(this.maskGraphics.x=this.player.x,this.maskGraphics.y=this.player.y,this.blackout.setPosition(this.cameras.main.scrollX,this.cameras.main.scrollY)),this.isGameOver||(this.player.x>this.goalX&&(this.goal(),this.player.body.setVelocityX(0)),this.timer+=s,this.player.update(t,s))}checkBGMPoint(){if(0==this.bgmIndex&&this.player.x>this.bgm2PositionX){let t=this.tweens.createTimeline();t.add({targets:this.bgm,volume:0,duration:2e3,onComplete:()=>{this.bgm.stop(),this.bgm2.play()}}),t.add({targets:this.bgm2,volume:.3,duration:4e3}),t.play(),this.bgmIndex=1}if(1==this.bgmIndex&&this.player.x>this.bgm3PositionX){let t=this.tweens.createTimeline();this.bgm.stop(),t.add({targets:this.bgm2,volume:0,duration:1e3,onComplete:()=>{this.bgm2.stop(),this.bgm3.play({volume:0})}}),t.add({targets:this.bgm3,volume:.3,duration:4e3}),t.play(),this.bgmIndex=2}}checkCheckPoint(){this.config.playerType!=i.GOLD&&this.player.x>this.nextCheckPoint.x&&(this.ui.showCheckPointEffect(),this.checkPointIndex++,this.respawnPoint.x=this.nextCheckPoint.x,this.respawnPoint.y=this.nextCheckPoint.y-(this.player.body.height+10),this.checkPointIndex>=this.checkPoints.length?this.nextCheckPoint.x=this.goalX+2e3:(this.nextCheckPoint.x=this.checkPoints[this.checkPointIndex].x,this.nextCheckPoint.y=this.checkPoints[this.checkPointIndex].y))}checkBackground(){this.player.x>this.background2Spot&&this.backgroundMode<1&&(this.background2.visible=!0,this.background3.visible=!1,this.background.visible=!1,this.backgroundMode=1),this.player.x>this.background3Spot&&this.backgroundMode<2&&(this.background3.visible=!0,this.background2.visible=!1,this.background.visible=!1,this.backgroundMode=2)}calcScore(){return Math.floor(.05*Math.abs(this.player.x-this.startX))}}class b extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.load.image("phaser-logo","assets/img/phaser-logo.png"),this.load.image("tileset1","assets/tilemaps/tilemap1.png"),this.load.tilemapTiledJSON("map","assets/tilemaps/world.json"),this.load.image("background","assets/img/background.png"),this.load.image("background2","assets/img/background2.png"),this.load.image("background3","assets/img/background3.png"),this.load.spritesheet("oji","assets/sprite/ojisandot.png",{frameWidth:32,frameHeight:32}),this.load.animation("ojiAnim","assets/sprite/oji.json"),this.load.image("oji_face","assets/sprite/face.png"),this.load.image("oji_hunbari","assets/sprite/hunbari.png"),this.load.spritesheet("kozo","assets/sprite/kozo.png",{frameWidth:32,frameHeight:32}),this.load.animation("kozoAnim","assets/sprite/kozo.json"),this.load.image("kozo_face","assets/sprite/kozo_face.png"),this.load.image("kozo_hunbari","assets/sprite/kozo_hunbari.png"),this.load.spritesheet("madame","assets/sprite/madame.png",{frameWidth:32,frameHeight:32}),this.load.animation("madameAnim","assets/sprite/madame.json"),this.load.image("madame_face","assets/sprite/madame_face.png"),this.load.image("madame_hunbari","assets/sprite/madame_hunbari.png"),this.load.spritesheet("neko","assets/sprite/neko.png",{frameWidth:32,frameHeight:32}),this.load.animation("nekoAnim","assets/sprite/neko.json"),this.load.image("neko_face","assets/sprite/neko_face.png"),this.load.image("neko_hunbari","assets/sprite/neko_hunbari.png"),this.load.spritesheet("hakase","assets/sprite/hakase.png",{frameWidth:32,frameHeight:32}),this.load.animation("hakaseAnim","assets/sprite/hakase.json"),this.load.image("hakase_face","assets/sprite/hakase_face.png"),this.load.image("hakase_hunbari","assets/sprite/hakase_hunbari.png"),this.load.spritesheet("gold","assets/sprite/gold.png",{frameWidth:32,frameHeight:32}),this.load.animation("goldAnim","assets/sprite/gold.json"),this.load.image("gold_face","assets/sprite/gold_face.png"),this.load.spritesheet("selectButton","assets/sprite/selectButton.png",{frameWidth:50,frameHeight:50}),this.load.animation("selectButtonAnim","assets/sprite/selectButton.json"),this.load.image("fullScreen","assets/img/fullscreen.png"),this.load.image("onara","assets/img/onara.png"),this.load.image("ohana","assets/img/ohana.png"),this.load.image("setumei1","assets/img/setumei1.png"),this.load.image("setumei2","assets/img/setumei2.png"),this.load.image("setumei3","assets/img/setumei3.png"),this.load.image("setumei3_oji","assets/img/setumei3_oji.png"),this.load.image("setumei3_kozo","assets/img/setumei3_kozo.png"),this.load.image("setumei3_madame","assets/img/setumei3_madame.png"),this.load.image("setumei3_neko","assets/img/setumei3_neko.png"),this.load.image("setumei3_gold","assets/img/setumei3_gold.png"),this.load.image("setumei_hakase","assets/img/setumei_hakase.png"),this.load.image("flower_mode_on","assets/img/flower_mode_on.png"),this.load.image("flower_mode_off","assets/img/flower_mode_off.png"),this.load.bitmapFont("font","assets/font/font.png","assets/font/font.fnt"),this.load.image("logo","assets/img/logoButton.png"),this.load.image("retry","assets/img/retry.png"),this.load.image("share_x","assets/img/share_x.png"),this.load.image("title","assets/img/title.png"),this.load.image("goal","assets/img/goal.png"),this.load.audio("onara1","assets/sound/onara_001.mp3"),this.load.audio("onara2","assets/sound/onara_002.mp3"),this.load.audio("onara3","assets/sound/onara_018.mp3"),this.load.audio("onara4","assets/sound/onara_022.mp3"),this.load.audio("onara5","assets/sound/onara_026.mp3"),this.load.audio("onara6","assets/sound/onara_029.mp3"),this.load.audio("onara7","assets/sound/onara_047.mp3"),this.load.audio("onara8","assets/sound/onara_051.mp3"),this.load.audio("onara9","assets/sound/onara_054.mp3"),this.load.audio("onara10","assets/sound/onara_056.mp3"),this.load.audio("onara11","assets/sound/onara_057.mp3"),this.load.audio("ohana1","assets/sound/maou_se_onepoint09.mp3"),this.load.audio("ohana2","assets/sound/maou_se_onepoint12.mp3"),this.load.audio("ohana3","assets/sound/VSQ_JINGLE_0103_harp_04.mp3"),this.load.audio("ohana4","assets/sound/VSQ_JINGLE_0103_harp_05.mp3"),this.load.audio("onara_hakase","assets/sound/bike.mp3"),this.load.audio("ohana_hakase","assets/sound/VSQ_JINGLE_0103_harp_05.mp3"),this.load.audio("bgm1","assets/sound/oo39_ys114.mp3"),this.load.audio("bgm2","assets/sound/oo39_ys018.mp3"),this.load.audio("bgm3","assets/sound/nereia1.mp3"),this.load.image("credit","assets/img/credit.png"),this.load.audio("checkPoint","assets/sound/checkpoint.mp3"),this.load.audio("respawn","assets/sound/pahu.mp3"),this.load.audio("gameover","assets/sound/tin.mp3"),this.load.audio("lifeup","assets/sound/yaho.mp3"),this.load.audio("pon","assets/sound/pon.mp3"),this.load.image("go","assets/img/go.png")}create(){this.scene.start("TitleScene")}}const f=[{score:0,rank:"へとびのめざめ"},{score:250,rank:"へとびのたまご"},{score:500,rank:"へとびのたんじょう"},{score:750,rank:"へとびルーキー"},{score:1e3,rank:"いっぱしのへとび"},{score:1250,rank:"へとびのセンパイ"},{score:1500,rank:"へとびのあにき"},{score:1750,rank:"へとびのだんな"},{score:2e3,rank:"へとびのしんせい"},{score:2250,rank:"へとびのごうけつ"},{score:2500,rank:"へとびのたつじん"},{score:2750,rank:"へとびのしゃちょう"},{score:3e3,rank:"プレジデントへとび"},{score:3250,rank:"へとびのだいおう"},{score:3500,rank:"へとびのむこうがわ"},{score:3750,rank:"へとびロケット"},{score:4e3,rank:"へとびトルネード"},{score:4250,rank:"へとびのいなずま"},{score:4500,rank:"へとびのドラゴン"},{score:4750,rank:"へとびのほし"},{score:5e3,rank:"へとびをさとりしもの"},{score:5250,rank:"へとびのかみさま"}];class g extends Phaser.Scene{constructor(t){super({key:"MainUIScene"}),this.isFullScreen=!1}init(){this.config=o.getInstance(),this.mainScene=this.scene.get("MainScene");let t="oji_face";t=this.config.playerType+"_face";const s=this.add.image(50,50,t).setOrigin(.5,.5).setScale(4);let e=5;switch(this.config.playerType){case i.MADAME:e=7;break;case i.KOZO:e=10;break;case i.NEKO:e=20;break;case i.HAKASE:e=8;break;case i.GOLD:e=0}this.lifeText=this.add.bitmapText(100,50,"font","x"+e,100,1e3).setOrigin(0,.5),this.lifeText.tint=16737894,this.config.playerType===i.GOLD&&(this.lifeText.visible=!1,s.visible=!1),this.parentScene=this.scene.get("MainScene"),this.fpsText=new a(this),this.fpsText.visible=!1,this.background=this.add.rectangle(0,0,1920,1080,0,.7).setOrigin(0,0),this.background.visible=!1,this.uiContainer=this.add.container(0,0),this.add.image(1420,60,"fullScreen").setOrigin(.5,.5).setScale(.8).setAlpha(.7).setInteractive().on("pointerdown",(()=>{this.isFullScreen?(this.scale.stopFullscreen(),this.isFullScreen=!1):(this.scale.startFullscreen(),this.isFullScreen=!0)})),this.scale.on("orientationchange",(t=>{t===Phaser.Scale.PORTRAIT&&this.scale.lockOrientation("landscape")})),this.checkPointEffectContainer=this.add.container(750,100);const h=this.add.rectangle(0,0,2e3,150,13421568,.6),r=this.add.bitmapText(0,0,"font","CHECK POINT",110,1e3),n=this.add.bitmapText(5,5,"font","CHECK POINT",110,1e3);n.tint=0,this.checkPointEffectContainer.scaleY=0,r.setOrigin(.5,.5),n.setOrigin(.5,.5),this.checkPointEffectContainer.add(h),this.checkPointEffectContainer.add(n),this.checkPointEffectContainer.add(r),this.checkPointSE=this.sound.add("checkPoint")}setLifeText(t){this.lifeText.setText("x"+t)}gameOver(t,s){this.background.visible=!0,this.background.alpha=0,this.tweens.add({targets:this.background,alpha:1,duration:500,ease:""}),this.showResult(t,s)}showResult(t,s,e=!1){const a=s,h=this.formatTime(t);let o="へとびおじ";switch(this.config.playerType){case i.OJI:o="へとびおじ";break;case i.KOZO:o="へとびこぞう";break;case i.MADAME:o="へとびマダム";break;case i.NEKO:o="へとびねこ";break;case i.HAKASE:o="へとびはかせ";break;case i.GOLD:o="ゴールドおじ"}let r="へとびのめざめ";for(let t=0;t<f.length;t++)a>=f[t].score&&(r=f[t].rank);if(e)r="へとびのかみさま";else{let t=this.add.bitmapText(800,160,"font",a+"M",250,1e3);t.setOrigin(.5,.5),this.uiContainer.add(t)}let n=this.add.bitmapText(750,380,"font",h,100,2);n.setOrigin(0,1),this.uiContainer.add(n);let c=this.add.bitmapText(1200,450,"font","RANK : "+r,80,0).setOrigin(0,1);c.setOrigin(1,.5),this.uiContainer.add(c);let d=this.add.image(200,660,"logo").setOrigin(.5,.5).setInteractive().on("pointerup",(()=>{window.open("https://cachacacha.com","_blank")}));this.uiContainer.add(d);let p=this.add.image(800,620,"retry").setOrigin(.5,.5).setInteractive().on("pointerup",(()=>{this.mainScene.reload()}));this.uiContainer.add(p);let l=this.add.image(30,30,"credit").setOrigin(0,0).setInteractive().on("pointerup",(()=>{window.open("./credit.html","_blank")}));l.setScale(1.1),this.uiContainer.add(l);let m=a+"M ブッぱなした";e&&(m="ゴーーーール！！");const u=o+"で"+m+" TIME:"+h+" RANK:"+r+" #かちゃコム #へとびおじ https://cachacacha.com/GAME/hetobioji";let y=this.add.image(1285,640,"share_x").setOrigin(.5,.5).setInteractive().on("pointerup",(()=>{window.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(u),"_blank")}));this.uiContainer.add(y);let b=this.add.bitmapText(200,450,"font",o,50,1e3);b.setOrigin(.5,.5),this.uiContainer.add(b);const g=this.add.sprite(180,300,this.config.playerType).setOrigin(.5,.5).setScale(7);g.play(this.config.playerType+"_jump"),this.uiContainer.add(g),this.uiContainer.x=800,this.tweens.add({targets:this.uiContainer,x:0,duration:1e3,ease:"Power2"}),this.uiContainer.alpha=0,this.tweens.add({targets:this.uiContainer,alpha:1,duration:1e3,ease:""})}formatTime(t){let s=Math.floor(t%1e3),e=Math.floor(t/1e3%60),i=Math.floor(t/1e3/60%60),a=Math.floor(t/1e3/60/60%24);const h=(t,s)=>String(t).padStart(s,"0");let o=h(i,2)+":"+h(e,2)+"."+h(s,3);return a>0&&(o=h(a,2)+":"+h(i,2)+":"+h(e,2)+"."+h(s,3)),o}goal(t,s){this.background.visible=!0,this.background.alpha=0,this.tweens.add({targets:this.background,alpha:1,duration:500,ease:""});let e=this.add.bitmapText(800,160,"font","ゴール!!",250,1e3);e.setScale(.5),e.setOrigin(.5,.5),e.x=1600;let i=this.tweens.createTimeline();i.add({targets:e,x:800,y:300,scale:1.3,duration:1e3,ease:"Power2"}),i.add({targets:e,duration:100,OncallBack:()=>{this.showResult(t,s,!0)}}),i.add({targets:e,x:800,y:150,scale:.8,duration:1e3,ease:"Power2"}),i.play()}update(t,s){this.fpsText.update()}showCheckPointEffect(){this.checkPointSE.play(),this.checkPointEffectContainer.scaleY=0,this.tweens.add({targets:this.checkPointEffectContainer,scaleX:1,scaleY:1,duration:500,ease:"Cubic.easeOut"}),this.time.addEvent({delay:1e3,callback:()=>{this.tweens.add({targets:this.checkPointEffectContainer,scaleX:1,scaleY:0,duration:500,ease:"Cubic.easeIn"})}})}}class k extends Phaser.Scene{constructor(){super({key:"TitleScene"})}create(){const t=this.add.image(0,0,"background").setOrigin(0,0);t.setDisplaySize(this.cameras.main.width,this.cameras.main.height),t.setScrollFactor(0);const s=this.add.image(0,0,"title");s.setScale(1),s.setPosition(740,140);const e=this.add.particles("onara").createEmitter({speed:500,scale:{start:.5,end:10},angle:{min:160,max:160},lifespan:1500,frequency:300,alpha:{start:1,end:0}}),i=this.add.sprite(0,0,"oji");i.setScale(5),i.setPosition(700,400),i.play("oji_jump"),this.tweens.add({targets:i,y:410,duration:200,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.tweens.add({targets:i,x:720,duration:1300,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),e.startFollow(i,20,30);const a=this.add.bitmapText(720,640,"font","タッチではじめる",100,1);a.setOrigin(.5,.5),a.setTint(5592490),this.tweens.add({targets:a,scaleX:1.1,scaleY:1.1,duration:1e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.input.on("pointerup",(()=>{this.scene.start("PlayerSelectScene")}))}}class w extends Phaser.Scene{constructor(){super({key:"PlayerSelectScene"}),this.selectedPlayer="oji",this.selectButtons=[],this.detailContainers=[],this.playerDetails={oji:{name:"へとびおじ",description:"へとびひとすじ40ねん\n\n2かいれんぞくでへをこける\nはちゃめちゃむずかしい"},kozo:{name:"へとびこぞう",description:"ぶかつをサボってへをこいている\n\n4かいれんぞくでへをこける\nまずまずのむずかしさ"},madame:{name:"へとびマダム",description:"ごくふつうのいっぱんじょせい\n\n3かいれんぞくでへをこける\nてごわいむずかしさ"},neko:{name:"へとびねこ",description:"IQ300のばけねこ\n\n6かいれんぞくでへをこける\nやさしめのむずかしさ"},hakase:{name:"へとびはかせ",description:"がっかいをついほうされた\n\nながおしでへをこきつづける\n"},gold:{name:"ゴールドおじ",description:"おうごんになったへとびおじ\n\nふっかつできない \nマジでじごくのむずかしさ"}},this.playerTypeIndex={oji:0,kozo:1,madame:2,neko:3,hakase:4,gold:5}}create(){this.config=o.getInstance();const t=this.add.image(0,0,"background").setOrigin(0,0);t.setDisplaySize(this.cameras.main.width,this.cameras.main.height),t.setScrollFactor(0),this.touchSE=this.sound.add("pon");const s=[830,1080,1330,1580],e=[120,340,560,780];this.createSelectButton(s[0],e[1],i.OJI),this.createSelectButton(s[1],e[0],i.KOZO),this.createSelectButton(s[2],e[0],i.MADAME),this.createSelectButton(s[0],e[0],i.NEKO),this.createSelectButton(s[1],e[1],i.HAKASE),this.createSelectButton(s[2],e[1],i.GOLD),this.createDetailContainer(i.OJI),this.createDetailContainer(i.KOZO),this.createDetailContainer(i.MADAME),this.createDetailContainer(i.NEKO),this.createDetailContainer(i.HAKASE),this.createDetailContainer(i.GOLD);const a=this.add.particles("onara").createEmitter({speed:400,scale:{start:2,end:10},angle:{min:160,max:160},lifespan:1500,frequency:300,alpha:{start:1,end:0}});a.setPosition(300,240);const h=this.add.particles("ohana").createEmitter({speed:400,scale:{start:.3,end:1},angle:{min:160,max:160},rotate:{start:0,end:180},lifespan:1500,frequency:300,alpha:{start:1,end:0}});h.setPosition(300,240),h.stop();const r=this.sound.add("onara5"),n=this.sound.add("ohana4"),c=this.add.container(910,630),d=this.add.sprite(0,0,"flower_mode_on");d.setScale(1.9),d.setInteractive(),d.visible=!1,c.add(d);const p=this.add.sprite(0,0,"flower_mode_off");p.setScale(1.9),p.setInteractive(),p.visible=!0,c.add(p),d.on("pointerup",(()=>{this.config.setIsOhana(!1),d.visible=!1,p.visible=!0,h.stop(),a.start(),a.visible=!0,h.visible=!1,r.play()})),p.on("pointerup",(()=>{this.config.setIsOhana(!0),d.visible=!0,p.visible=!1,h.start(),a.stop(),a.visible=!1,h.visible=!0,n.play({volume:.4})})),this.onSelectedPlayer(i.NEKO);const l=this.add.sprite(1300,600,"go");l.setScale(2),l.setInteractive(),l.on("pointerdown",(()=>{this.config.setPlayerType(this.selectedPlayer),this.scene.start("MainScene"),this.touchSE.play({rate:1})}))}onSelectedPlayer(t){this.selectedPlayer!=t&&(this.touchSE.play({rate:1.2}),this.selectedPlayer=t,this.selectButtons.forEach((t=>{t.play("off")})),this.detailContainers.forEach((t=>{t.visible=!1})),this.selectButtons[this.playerTypeIndex[t]].play("on"),this.detailContainers[this.playerTypeIndex[t]].visible=!0)}createSelectButton(t,s,e){const i=this.add.container(t,s),a=this.add.sprite(0,0,"selectButton");a.setScale(4),a.play("off"),a.setInteractive(),this.selectButtons.push(a),a.on("pointerdown",(()=>{this.onSelectedPlayer(e)})),i.add(a);const h=this.add.sprite(-10,0,e);h.setScale(5),h.play(e+"_jump"),i.add(h)}createDetailContainer(t){const s=this.add.container(40,50),e=this.add.container(0,300);s.add(e);const i=this.add.graphics();i.fillStyle(16769674,1),i.fillRect(0,0,640,350),e.add(i);const a=this.add.graphics();a.lineStyle(10,14460225,1),a.strokeRect(0,0,640,350),e.add(a);let h=this.add.bitmapText(330,60,"font",this.playerDetails[t].name,70,0);h.setTint(0),h.setOrigin(.5),e.add(h);const o=this.add.bitmapText(40,130,"font",this.playerDetails[t].description,40,0);o.setTint(0),o.setOrigin(0),e.add(o);const r=this.add.sprite(0,0,t);r.setScale(8),r.setPosition(300,100),r.play(t+"_jump"),s.add(r),this.tweens.add({targets:r,y:90,duration:200,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.detailContainers.push(s),s.visible=!1}}const x={type:Phaser.AUTO,backgroundColor:"#ffffff",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,orientation:Phaser.Scale.Orientation.LANDSCAPE,width:1480,height:720},pixelArt:!0,scene:[b,y,g,k,w],physics:{default:"arcade",arcade:{debug:!1,gravity:{y:350}}}};window.addEventListener("load",(()=>{new Phaser.Game(x)}))},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},e={};function i(t){var a=e[t];if(void 0!==a)return a.exports;var h=e[t]={exports:{}};return s[t].call(h.exports,h,h.exports,i),h.exports}i.m=s,t=[],i.O=(s,e,a,h)=>{if(!e){var o=1/0;for(d=0;d<t.length;d++){for(var[e,a,h]=t[d],r=!0,n=0;n<e.length;n++)(!1&h||o>=h)&&Object.keys(i.O).every((t=>i.O[t](e[n])))?e.splice(n--,1):(r=!1,h<o&&(o=h));if(r){t.splice(d--,1);var c=a();void 0!==c&&(s=c)}}return s}h=h||0;for(var d=t.length;d>0&&t[d-1][2]>h;d--)t[d]=t[d-1];t[d]=[e,a,h]},i.o=(t,s)=>Object.prototype.hasOwnProperty.call(t,s),(()=>{var t={179:0};i.O.j=s=>0===t[s];var s=(s,e)=>{var a,h,[o,r,n]=e,c=0;if(o.some((s=>0!==t[s]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(n)var d=n(i)}for(s&&s(e);c<o.length;c++)h=o[c],i.o(t,h)&&t[h]&&t[h][0](),t[h]=0;return i.O(d)},e=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];e.forEach(s.bind(null,0)),e.push=s.bind(null,e.push.bind(e))})(),i.O(void 0,[216],(()=>i(982)));var a=i.O(void 0,[216],(()=>i(204)));a=i.O(a)})();